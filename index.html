<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>âœ¨ SP04 Spreadsheet Wars Special Piece IVï¼šæˆ‘ä¸æƒ³ç­‰é£›æ©ŸçœŸçš„ä¸‹å¢œæ™‚ï¼Œæ‰é–‹å§‹å»æ¶é™è½å‚˜ï¼</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font for better readability */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6; /* Light gray background */
            color: #374151; /* Dark gray text */
            line-height: 1.6;
        }
        .container {
            max-width: 960px; /* Max width for content */
            margin: 0 auto; /* Center the container */
            padding: 1.5rem;
        }
        .section-title {
            font-size: 2.25rem; /* text-4xl */
            font-weight: 700; /* font-bold */
            color: #1f2937; /* Darker gray for titles */
            margin-bottom: 1.5rem;
            text-align: center;
        }
        .subsection-title {
            font-size: 1.5rem; /* text-2xl */
            font-weight: 600; /* font-semibold */
            color: #374151;
            margin-top: 2rem;
            margin-bottom: 1rem;
            border-bottom: 2px solid #e5e7eb; /* Light border */
            padding-bottom: 0.5rem;
        }
        .card {
            background-color: #ffffff;
            border-radius: 0.75rem; /* rounded-xl */
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1); /* shadow-md */
            padding: 1.5rem;
            margin-bottom: 1.5rem;
        }
        .item-list {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); /* Responsive grid for items */
            gap: 1rem;
        }

        /* Item card base styles */
        .item-card {
            border-radius: 0.5rem; /* rounded-lg */
            padding: 1rem;
            display: flex;
            flex-direction: column; /* Allow content to stack */
            justify-content: space-between;
            align-items: flex-start; /* Align text to left */
            font-size: 0.95rem;
            position: relative; /* For tooltip positioning */
            overflow: visible; /* Ensure tooltip is not clipped */
            text-decoration: none; /* Remove underline for links */
            color: inherit; /* Inherit text color for links */
            transition: border-width 0.2s ease-in-out, background-color 0.2s ease-in-out, transform 0.2s ease-in-out; /* Smooth transitions */
        }
        .item-card:hover {
            transform: translateY(-3px); /* Slight lift effect on hover */
        }

        /* Border thickness for links */
        .item-card.no-link {
            border-width: 1px; /* Thin border */
        }
        .item-card.has-link {
            border-width: 3px; /* Thick border */
        }

        /* Color categories */
        .category-water {
            background-color: #e0f2fe; /* light blue */
            border-color: #90cdf4; /* blue-300 */
        }
        .category-medical {
            background-color: #fee2e2; /* light red */
            border-color: #fca5a5; /* red-300 */
        }
        .category-food {
            background-color: #fffde7; /* light yellow */
            border-color: #fcd34d; /* yellow-300 */
        }
        .category-fuel {
            background-color: #fff7ed; /* light orange */
            border-color: #fdba74; /* orange-300 */
        }
        .category-other {
            background-color: #f3f4f6; /* light gray */
            border-color: #d1d5db; /* gray-300 */
        }

        /* Tooltip styles */
        .item-card .tooltip-details {
            visibility: hidden;
            background-color: rgba(0, 0, 0, 0.8);
            color: #fff;
            text-align: center;
            border-radius: 0.375rem; /* rounded-md */
            padding: 0.5rem 0.75rem;
            position: absolute;
            z-index: 10;
            bottom: 100%; /* Position above the item */
            left: 50%;
            transform: translateX(-50%) translateY(-0.5rem); /* Adjust position slightly above */
            opacity: 0;
            transition: opacity 0.3s, transform 0.3s;
            white-space: nowrap; /* Prevent text wrapping */
            pointer-events: none; /* Allow clicks through tooltip */
        }
        .item-card:hover .tooltip-details {
            visibility: visible;
            opacity: 1;
            transform: translateX(-50%) translateY(-1rem); /* Move up slightly on hover */
        }
        .item-card .tooltip-details::after {
            content: "";
            position: absolute;
            top: 100%;
            left: 50%;
            margin-left: -0.375rem; /* Half of border-width for centering */
            border-width: 0.375rem;
            border-style: solid;
            border-color: rgba(0, 0, 0, 0.8) transparent transparent transparent;
        }

        /* Text colors inside item card */
        .item-card strong {
            color: #1f2937; /* Darker text for item name */
        }
        .item-card span {
            color: #ef4444; /* Red for cost */
            font-weight: 500;
        }
        .footer-text {
            font-size: 1rem;
            text-align: center;
            margin-top: 3rem;
            color: #6b7280;
        }
        .item-controls {
            display: flex;
            align-items: center;
            gap: 0.5rem;
            margin-top: 0.5rem;
            width: 100%; /* Ensure controls take full width */
            justify-content: space-between; /* Space out checkbox and quantity */
        }
        .item-controls input[type="checkbox"] {
            transform: scale(1.2); /* Slightly larger checkbox */
            cursor: pointer;
        }
        .item-controls input[type="number"] {
            width: 4rem; /* Fixed width for quantity input */
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            border: 1px solid #d1d5db;
            text-align: center;
            -moz-appearance: textfield; /* Hide arrows in Firefox */
        }
        /* Hide arrows in Chrome, Safari, Edge */
        .item-controls input[type="number"]::-webkit-outer-spin-button,
        .item-controls input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        .item-card.checked {
            opacity: 0.7; /* Dim checked items */
            background-color: #f0fdf4; /* Light green for checked items */
            border-color: #86efac; /* Green border for checked items */
        }
    </style>
</head>
<body class="antialiased">
    <div class="container">
        <!-- Header Section -->
        <header class="py-8 text-center">
            <h1 class="text-4xl md:text-5xl font-extrabold text-gray-900 leading-tight mb-4 rounded-lg p-4 bg-gradient-to-r from-blue-500 to-purple-600 text-white shadow-lg">
                âœ¨ SP04ã€ŠSpreadsheet Wars Special Piece IVï¼šæˆ‘ä¸æƒ³ç­‰é£›æ©ŸçœŸçš„ä¸‹å¢œæ™‚ï¼Œæ‰é–‹å§‹å»æ¶é™è½å‚˜ï¼ã€‹
            </h1>
            <p class="text-xl md:text-2xl text-gray-700 font-medium mb-8">
                å°ç£æ­£è™•æ–¼å¹³è¡Œæ™‚ç©ºçš„åˆ†æ­§é»ã€‚å°±åƒä¸€éƒ¨å¤šé‡å®‡å®™é›»å½±ï¼Œç¾åœ¨çš„ä¸€å¿µé¸æ“‡ï¼Œå°‡é–‹å•Ÿæœªä¾†æˆªç„¶ä¸åŒçš„ä¸–ç•Œç·šã€‚
            </p>
        </header>

        <!-- Progress Summary Section -->
        <section class="card mb-8 p-6 bg-blue-50 border-l-4 border-blue-400">
            <h2 class="text-2xl font-semibold text-blue-800 mb-4">æˆ‘çš„é˜²ç½åŒ…é€²åº¦</h2>
            <p class="text-lg text-blue-700">
                æ‚¨å·²å‹¾é¸ <span id="checkedItemsCount" class="font-bold text-3xl">0</span> å€‹å“é …ï¼Œç¸½è¨ˆ <span id="totalItemsCount" class="font-bold text-3xl">0</span> å€‹ã€‚
            </p>
            <p class="text-lg text-blue-700 mt-2">
                å·²å‹¾é¸å“é …é ä¼°ç¸½é‡‘é¡ï¼š<span id="totalEstimatedCost" class="font-bold text-3xl text-red-600">NT$ 0</span>
            </p>
            <p class="text-sm text-blue-600 mt-2">
                ç¹¼çºŒåŠªåŠ›ï¼Œè®“æ‚¨çš„å®¶åº­æ›´å®‰å…¨ï¼
            </p>
        </section>

        <!-- Introduction Section -->
        <section class="card">
            <h2 class="section-title">å¼•è¨€</h2>
            <blockquote class="text-lg italic text-gray-600 mb-6 border-l-4 border-blue-500 pl-4">
                ã€Œåœ¨æˆ°çˆ­èˆ‡å±ˆè¾±é¢å‰ï¼Œä½ é¸æ“‡äº†å±ˆè¾±ï¼å¯æ˜¯ï¼Œå±ˆè¾±éå¾Œï¼Œä½ ä»å¾—é¢å°æˆ°çˆ­ï¼ã€
                <footer class="mt-2 text-sm text-gray-500">â€” å·²æ•…è‹±åœ‹é¦–ç›¸ï¼Œæº«æ–¯é “Â·ä¸˜å‰çˆ¾(1938)</footer>
            </blockquote>
            <p class="mb-4">
                é€™ç¯‡æ–‡ç« æ¢è¨äº†å¦‚æœä½ çŸ¥é“ä¸€å€‹é¸æ“‡å¯èƒ½å°è‡´å…©æ¢å®Œå…¨ä¸åŒçš„ä¸–ç•Œç·šï¼Œä½ æœƒé¸æ“‡ææ—©æº–å‚™ï¼Œé‚„æ˜¯è¢–æ‰‹æ—è§€ç¹¼çºŒç­‰å¾…ï¼Ÿ
            </p>
            <p class="mb-4">
                ä½œè€…è¿‘å…©å€‹æœˆé€²è¡Œäº†ä¸€é …ã€Œå¸Œæœ›æ°¸é ç”¨ä¸åˆ°ï¼Œä½†ä¸€æ—¦éœ€è¦å°±é—œä¹ç”Ÿæ­»ã€çš„ä»»å‹™ï¼šæº–å‚™å®¶åº­ç½é›£åŒ…ã€‚
            </p>
            <p class="mb-4">
                æº–å‚™é€™äº›çœŸçš„å¾ˆè€—ç¥ã€è€—éŒ¢ä¹Ÿè€—æ™‚é–“ï¼Œå¯èƒ½å¾—èŠ±è²»ä¸€æ•´å€‹æœˆçš„è–ªæ°´ã€‚ä½†æ›ä¾†çš„ï¼Œæ˜¯å…§å¿ƒçš„å®‰å®šæ„Ÿï¼Œé‚„æœ‰ç•¶æ„å¤–ç™¼ç”Ÿæ™‚ï¼Œä¸è‡³æ–¼åªèƒ½æ‰‹å¿™è…³äº‚æ¶ç‰©è³‡ï¼Œé¿å…ç­‰åˆ¥äººå‘Šè¨´ä½ æ€éº¼è¾¦çš„é‚£ç¨®è¢«å‹•æ„Ÿã€‚
            </p>
            <p class="mb-4">
                é¢±é¢¨ã€åœ°éœ‡ã€ç–«æƒ…ï¼Œå¤§å®¶éƒ½æœƒåšä¸€é»æº–å‚™ï¼Œä½†é¢å°æ›´æ¥µç«¯ä¸”è¤‡åˆå¼çš„é¢¨éšªï¼Œåè€Œæœƒå› ç‚ºå¤ªæ²‰é‡ï¼Œè€Œé¸æ“‡å£“æŠ‘èˆ‡å¿½ç•¥ä¸å®‰ã€‚ä½†äº‹å¯¦ä¸Šï¼Œæˆ°çˆ­å°±æ˜¯æœ€é«˜å¼·åº¦çš„ç¶œåˆç½é›£ï¼šæ°´é›»ä¸­æ–·ã€ç‰©è³‡çŸ­ç¼ºã€è³‡è¨Šå°é–ã€ç¶²è·¯ç™±ç˜“ã€é†«ç™‚ç™±ç˜“ã€äº¤é€šåœæ“ºã€è²¡ç”¢å–ªå¤±ã€äººèº«å¨è„…ï¼Œä»¥åŠå„ç¨®å‹æ…‹çš„æš´åŠ›èˆ‡ä¾µå®³ã€‚ä¸ç®¡ä½ çš„èº«åˆ†èˆ‡åƒ¹å€¼è§€ï¼Œé€™äº›ç½é›£éƒ½ä¸æœƒå…ˆæ•²é–€è©¢å•ä½ çš„åŒæ„ï¼šã€ŒHey, bro! Do you want a battle?ã€
            </p>
            <p>
                æˆ‘å¸Œæœ›è‡ªå·±èƒ½åšæ±ºå®šï¼Œè€Œä¸æ˜¯åœ¨åˆ¥äººæ±ºå®šå¾Œè¢«è¿«æ¥å—çµæœã€‚ç”Ÿå­˜èˆ‡å°Šåš´ï¼Œä¹Ÿæ‡‰è©²æ˜¯æˆ‘å€‘ä¸»å‹•åšå‡ºçš„é¸æ“‡ï¼Œè€Œä¸æ˜¯å¯„è¨—æ•µäººçš„ä»æ…ˆèˆ‡å–„æ„ï¼Œæˆ–è®“ä»–äººæ›¿æˆ‘å€‘è¦åŠƒã€‚
            </p>
        </section>

        <!-- Disaster Kit Contents Section -->
        <section class="card">
            <h2 class="section-title">é˜²ç½åŒ…å…§å®¹æ¸…å–®</h2>
            <p class="mb-6 text-center text-gray-600">
                ã€Œæº–å‚™ä¸å®Œå…¨ï¼Œä¹Ÿå‹éå®Œå…¨ä¸æº–å‚™ã€â€” é€™æ˜¯ä¸€ä»½æˆ‘å€‘ç‚ºå®¶åº­æº–å‚™çš„é˜²ç½åŒ…æ¸…å–®ï¼Œå¸Œæœ›èƒ½ç‚ºæ‚¨æä¾›ä¸€äº›åƒè€ƒã€‚
            </p>

            <h3 class="subsection-title">æ ¸å¿ƒå¿…éœ€å“</h3>
            <ul class="list-disc list-inside text-gray-700 mb-6 space-y-2">
                <li>é£²æ°´</li>
                <li>ç³§é£Ÿ</li>
                <li>é†«ç™‚ç”¨å“</li>
                <li>è¡›ç”Ÿç”¨å“</li>
                <li>èƒ½æºç‡ƒæ–™</li>
                <li>é€šè¨Šè¨­å‚™</li>
                <li>é¿é›£åœ°é»è¦åŠƒ</li>
            </ul>

            <h3 class="subsection-title">è©³ç´°å“é …èˆ‡é ä¼°é‡‘é¡ (åƒè€ƒ)</h3>
            <div id="disaster-kit-items-container" class="item-list">
                <!-- Items will be dynamically generated here by JavaScript -->
            </div>
            <p class="mt-6 text-center text-gray-600 italic">
                â€» æ¨è–¦è³¼è²·ä¾†æºå°‡åœ¨å¾ŒçºŒæ•´ç†æ›´å®Œæ•´å¾Œé™„ä¸Šã€‚
            </p>
        </section>

        <!-- Conclusion Section -->
        <section class="card">
            <h2 class="section-title">çµèª</h2>
            <p class="mb-4">
                å¦‚æœä¹Ÿæ›¾ç¶“è¦ºå¾—ç„¦æ…®ï¼Œä¸å¦¨è²¼è¿‘ã€Œç¬¬ä¸€æ€§åŸç†ã€ä¾†æ€è€ƒï¼š
            </p>
            <ul class="list-disc list-inside text-gray-700 mb-6 space-y-2">
                <li>ä½ çœŸæ­£çš„ç„¦æ…®èˆ‡æ“”å¿ƒæ˜¯ä»€éº¼ï¼Ÿï¼ˆç”Ÿå‘½è²¡ç”¢ï¼Ÿç”Ÿæ´»æ–¹å¼ï¼Ÿä¸‹ä¸€ä»£ï¼Ÿâ€¦ï¼‰</li>
                <li>è®“ä½ ä¸å®‰çš„å› ç´ ä¾†è‡ªå“ªè£¡ï¼Ÿï¼ˆäººï¼Ÿäº‹ï¼Ÿç‰©ï¼Ÿâ€¦ï¼‰</li>
                <li>ä½ ç¾åœ¨èƒ½åšçš„æœ‰ä»€éº¼ï¼Ÿï¼ˆå¼·åŒ–å€‹é«”éŸŒæ€§ï¼Ÿå®¶åº­æº–å‚™ï¼Ÿç¥ˆç¦±ï¼Ÿâ€¦ï¼‰</li>
            </ul>
            <p class="mb-4">
                é€™äº›å•é¡Œçš„ç­”æ¡ˆï¼Œæ¯å€‹äººæ‡‰è©²ä¸æœƒä¸€æ¨£ï¼Œä½†èƒ½å¹«åŠ©æˆ‘å€‘é‡æ¸…â”€â”€ä»€éº¼æ˜¯è®“ä½ ç„¦æ…®çš„æºé ­ï¼Ÿä»€éº¼è¡Œå‹•èƒ½è®“ä½ æ„Ÿåˆ°å®‰å¿ƒï¼Ÿ
            </p>
            <p class="mb-6 text-center text-lg font-semibold text-blue-700">
                ã€Œç•¶é£›æ©Ÿé–‹å§‹ä¸‹å¢œæ™‚ï¼Œä½ è¦ç­‰åˆ¥äººéçµ¦ä½ é™è½å‚˜ï¼Ÿé‚„æ˜¯ç¾åœ¨ï¼Œå°±ç‚ºè‡ªå·±æº–å‚™ä¸€æŠŠï¼Ÿã€
            </p>
            <p class="mb-4 text-center">
                ç«™å‡ºä¾†ï¼Œå°±æ˜¯é¸æ“‡ä¸ä¾è³´åˆ¥äººçš„å–„æ„æ›¿ä½ æ±ºå®šæœªä¾†ï¼
            </p>
            <p class="footer-text">
                â”€â”€SpreadSheetWars SP04ï¼Œèˆªè¡Œæ—¥èªŒç´€éŒ„å®Œæˆã€‚â”€â”€
            </p>
            <p class="footer-text mt-4">
                ï¿½ è‹¥æ‚¨è¦ºå¾—é€™ç¯‡å…§å®¹å°æ‚¨æˆ–æ‚¨çš„å®¶äººæœ‰æ‰€å¹«åŠ©ï¼Œæ­¡è¿åˆ†äº«ã€è½‰è²¼æˆ–é‡è£½ã€‚
            </p>
            <p class="footer-text">
                ğŸ§© åœ‹å®¶çš„éŸŒæ€§ï¼Œå¾æ¯å€‹å®¶åº­çš„æº–å‚™é–‹å§‹ã€‚
            </p>
            <p class="footer-text">
                âœ¨ é¡˜æ°‘ä¸»èˆ‡ç¹æ¦®èˆ‡æˆ‘å€‘åŒåœ¨â”€â”€ç›´åˆ°æ°¸é ï¼
            </p>
        </section>

        <footer class="py-8 text-center text-gray-500 text-sm">
            <p>&copy; 2025 Spreadsheet Wars. All rights reserved.</p>
            <p>#ç½é›£æº–å‚™ #é˜²è¡›æ„è­˜ #ç¬¬ä¸€æ€§åŸç† #å®¶åº­è²¬ä»» #SpreadSheetWars</p>
            <p>#DisasterPreparedness #DefenseAwareness #FirstPrinciples #FamilyResponsibility #SpreadSheetWars</p>
        </footer>
    </div>

    <script>
        // Define the disaster kit items data
        // ç‚ºäº†æ–¹ä¾¿ç®¡ç†å’Œäº’å‹•ï¼Œå°‡å“é …è³‡æ–™å®šç¾©ç‚º JavaScript ç‰©ä»¶é™£åˆ—
        const disasterKitItems = [
            // é£²æ°´ç›¸é—œ (Water Category)
            { id: 'item-01', name: 'POW-R1èƒ½é‡ç£š(250g) x16ä»½', price: 4480, category: 'food', details: 'æ¯”åˆ©æ™‚ POW-R1 èƒ½é‡ç£š x16ä»½ã€‚å¯ç›´æ¥é£Ÿç”¨æˆ–åŠ æ°´æ²–æ³¡ã€‚', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-03', name: 'æ—¥æœ¬KOKUYOé˜²ç½æ¿¾æ°´å™¨', price: 1100, category: 'water', details: 'æ—¥æœ¬ KOKUYO é˜²ç½æ¿¾æ°´å™¨', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-05', name: 'æ—¥æœ¬MochiGooé˜²æ°´æ°´å£º8L x8å€‹', price: 1172, category: 'water', details: 'æ—¥æœ¬ MochiGoo é˜²æ°´æ°´å£º 8L x8å€‹', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-06', name: 'ç¾åœ‹Portable Aquaæ·¨æ°´åŠ‘(12é¡†/20å‡ç”¨)', price: 588, category: 'water', details: 'ç¾åœ‹ Portable Aqua æ·¨æ°´åŠ‘ (12é¡†/20å‡ç”¨)', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-07', name: 'ç¾åœ‹Sawyer Miniæ¿¾æ°´å™¨', price: 2528, category: 'water', details: 'ç¾åœ‹ Sawyer Mini æ¿¾æ°´å™¨', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-08', name: 'ç¾åœ‹LifeStrawæ¿¾æ°´å™¨', price: 1580, category: 'water', details: 'ç¾åœ‹ LifeStraw æ¿¾æ°´å™¨', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-09', name: 'ç¾åœ‹Grayléæ¿¾æ°´å£º', price: 1120, category: 'water', details: 'ç¾åœ‹ Grayl éæ¿¾æ°´å£º', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-12', name: 'ç¾åœ‹LifeStrawPeakç”Ÿå‘½å¸ç®¡', price: 2430, category: 'water', details: 'ç¾åœ‹ LifeStraw Peak ç”Ÿå‘½å¸ç®¡', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-13', name: 'å°ç£ADiSæˆ¶å¤–æ·¨æ°´å™¨+ADiSè¿·ä½ æ¿¾æ°´å™¨', price: 1380, category: 'water', details: 'å°ç£ ADiS æˆ¶å¤–æ·¨æ°´å™¨ + ADiS è¿·ä½ æ¿¾æ°´å™¨', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-17', name: 'ç¾åœ‹KATADYNéæ¿¾å­¢å›Š(30é¡†è£)', price: 1275, category: 'water', details: 'ç¾åœ‹ KATADYN éæ¿¾å­¢å›Š (30é¡†è£)', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-19', name: 'ç¾åœ‹Sawyer Miniæ¿¾æ°´å™¨', price: 1122, category: 'water', details: 'ç¾åœ‹ Sawyer Mini æ¿¾æ°´å™¨', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-20', name: 'ç¾åœ‹WaterBOBæµ´ç¼¸å„²æ°´è¢‹', price: 2200, category: 'water', details: 'ç¾åœ‹ WaterBOB æµ´ç¼¸å„²æ°´è¢‹', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-22', name: 'ç¾åœ‹LifeStrawPeakç”Ÿå‘½å¸ç®¡', price: 1200, category: 'water', details: 'ç¾åœ‹ LifeStrawPeak ç”Ÿå‘½å¸ç®¡', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-25', name: 'å°ç£ADiSé˜²ç½æ¿¾æ°´å™¨+ADiSè¿·ä½ æ¿¾æ°´å™¨', price: 1760, category: 'water', details: 'å°ç£ ADiS é˜²ç½æ¿¾æ°´å™¨ + ADiS è¿·ä½ æ¿¾æ°´å™¨', link: 'http://robert3h.github.io/disaster-kit/' },

            // é†«ç™‚è¡›ç”Ÿ (Medical Category)
            { id: 'item-02', name: 'æ—¥æœ¬SATAKEä¹¾ç‡¥é£¯', price: 5589, category: 'medical', details: 'æ—¥æœ¬ SATAKE é©…èšŠè²¼', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-10', name: 'å¸¸ç”¨æŠ—ç”Ÿç´ è»Ÿè†', price: 975, category: 'medical', details: 'å¸¸ç”¨æŠ—ç”Ÿç´ è»Ÿè†', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-11', name: 'å°ç£ADiSé˜²æ°´é›¨æŠ«+ç¡è¢‹', price: 180, category: 'medical', details: 'æ—¥æœ¬ ADiS é˜²æ°´é›¨æŠ« + ç¡è¢‹', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-14', name: 'æä¸€è—¥å“', price: 883, category: 'medical', details: 'æä¸€è—¥å“', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-15', name: 'ç¾æ³°å¾·è—¥å“', price: 497, category: 'medical', details: 'ç¾æ³°å¾·è—¥å“', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-16', name: 'ç°¡æ˜“å°¿è¢‹(2å€‹)', price: 157, category: 'medical', details: 'ç°¡æ˜“å°¿è¢‹ (2å€‹)', link: 'http://robert3h.github.io/disaster-kit/' },

            // é£²é£Ÿç›¸é—œ (Food Category)
            { id: 'item-23', name: 'ç¾åœ‹NRG-5æˆ°å‚™å£ç³§', price: 890, category: 'food', details: 'ç¾åœ‹ NRG-5 æˆ°å‚™å£ç³§', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-24', name: 'å¾·åœ‹POW-R1èƒ½é‡ç£š(250g) x4ä»½', price: 1110, category: 'food', details: 'æ—¥æœ¬ POW-R1 èƒ½é‡ç£š (250g) x4ä»½', link: 'http://robert3h.github.io/disaster-kit/' },

            // èƒ½æºç‡ƒæ–™ (Fuel Category)
            { id: 'item-04', name: 'æ—¥æœ¬Panasonic EVOLTAéˆ¦å…ƒç´ é¹¼æ€§é›»æ± ', price: 807, category: 'fuel', details: 'EVAPORAMA EVOLTA å¯æ”œå¸¶å‹é›»æ± ', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-18', name: 'ç¾åœ‹CampMaidå›ºé«”ç‡ƒæ–™å¡Š(12é¡†è£) x5 +ç¾åœ‹MontBelléˆ¦åˆé‡‘æ¹¯åŒ™', price: 744, category: 'fuel', details: 'ç¾åœ‹ CampMaid å›ºé«”ç‡ƒæ–™å¡Š (12é¡†è£) x5 + éˆ¦åˆé‡‘æ¹¯åŒ™', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-21', name: 'ç¾åœ‹æˆ°è¡“é›»å¼§é»ç«æ‰‹é›»ç­’', price: 1580, category: 'fuel', details: 'ç¾åœ‹ æˆ°è¡“é›»å¼§é»ç«æ‰‹é›»ç­’', link: 'http://robert3h.github.io/disaster-kit/' },

            // å…¶ä»– (Other Category)
            { id: 'item-26', name: 'ä¸­åœ‹Keithéˆ¦é‡‘å±¬ç­·å­(560)+å‰åŒ™(465)-æŠ˜æ‰£(263)', price: 762, category: 'other', details: 'ä¸­åœ‹ Keith éˆ¦é‡‘å±¬ç­·å­ (560) + å‰åŒ™ (465) - æŠ˜æ‰£ (263)', link: 'http://robert3h.github.io/disaster-kit/' },
            { id: 'item-27', name: 'å°ç£ADi AV-03å…åŸ·ç…§å°è¬›æ©Ÿ2éš»ä¸€çµ„', price: 2514, category: 'other', details: 'å°ç£ ADi AV-03 å…åŸ·ç…§å°è¬›æ©Ÿ 2éš»ä¸€çµ„', link: 'http://robert3h.github.io/disaster-kit/' },
        ];

        // Function to get saved state from Local Storage
        function getSavedState() {
            try {
                const savedState = localStorage.getItem('disasterKitState');
                return savedState ? JSON.parse(savedState) : {};
            } catch (e) {
                console.error("Error loading state from Local Storage:", e);
                return {};
            }
        }

        // Function to save state to Local Storage
        function saveState(state) {
            try {
                localStorage.setItem('disasterKitState', JSON.stringify(state));
            } catch (e) {
                console.error("Error saving state to Local Storage:", e);
            }
        }

        // Initialize items with saved state
        let currentItemsState = getSavedState();
        disasterKitItems.forEach(item => {
            if (currentItemsState[item.id]) {
                item.checked = currentItemsState[item.id].checked;
                item.quantity = currentItemsState[item.id].quantity;
            } else {
                item.checked = false; // Default to unchecked
                item.quantity = 1;    // Default quantity
            }
        });

        // Function to render/re-render the item list
        function renderDisasterKitItems() {
            const container = document.getElementById('disaster-kit-items-container');
            container.innerHTML = ''; // Clear existing items

            disasterKitItems.forEach(item => {
                const isLink = item.link && item.link.length > 0;
                const itemElement = document.createElement(isLink ? 'a' : 'div'); // Use <a> for links, <div> otherwise
                if (isLink) {
                    itemElement.href = item.link;
                    itemElement.target = '_blank'; // Open in new tab
                    itemElement.rel = 'noopener noreferrer'; // Security best practice for target="_blank"
                }

                itemElement.className = `item-card ${isLink ? 'has-link' : 'no-link'} category-${item.category} ${item.checked ? 'checked' : ''}`;
                itemElement.setAttribute('data-id', item.id); // Store item ID for easy lookup

                itemElement.innerHTML = `
                    <div class="flex justify-between w-full items-center">
                        <strong class="text-gray-900">${item.name}</strong>
                        <span class="text-red-500 font-semibold">-${item.price.toLocaleString('zh-TW')}</span>
                    </div>
                    <div class="tooltip-details">${item.details}</div>
                    <div class="item-controls">
                        <label class="flex items-center gap-2 cursor-pointer">
                            <input type="checkbox" class="item-checkbox" ${item.checked ? 'checked' : ''}>
                            å·²æº–å‚™
                        </label>
                        <div class="flex items-center gap-1">
                            <label for="quantity-${item.id}">æ•¸é‡:</label>
                            <input type="number" id="quantity-${item.id}" class="item-quantity" value="${item.quantity}" min="1">
                        </div>
                    </div>
                `;

                container.appendChild(itemElement);

                // Add event listeners for checkbox and quantity input
                const checkbox = itemElement.querySelector('.item-checkbox');
                const quantityInput = itemElement.querySelector('.item-quantity');

                checkbox.addEventListener('change', (event) => {
                    item.checked = event.target.checked;
                    itemElement.classList.toggle('checked', item.checked);
                    updateStateAndSummary();
                });

                quantityInput.addEventListener('change', (event) => {
                    let newQuantity = parseInt(event.target.value, 10);
                    if (isNaN(newQuantity) || newQuantity < 1) {
                        newQuantity = 1; // Ensure quantity is at least 1
                        event.target.value = 1;
                    }
                    item.quantity = newQuantity;
                    updateStateAndSummary();
                });
            });
            updateSummary(); // Initial summary update after rendering
        }

        // Function to update the summary section and save state
        function updateStateAndSummary() {
            // Update currentItemsState based on disasterKitItems
            disasterKitItems.forEach(item => {
                currentItemsState[item.id] = {
                    checked: item.checked,
                    quantity: item.quantity
                };
            });
            saveState(currentItemsState); // Save the updated state
            updateSummary(); // Update the displayed summary
        }

        // Function to update the progress summary
        function updateSummary() {
            const checkedItems = disasterKitItems.filter(item => item.checked);
            const checkedCount = checkedItems.length;
            const totalCount = disasterKitItems.length;
            
            let totalEstimatedCost = 0;
            checkedItems.forEach(item => {
                totalEstimatedCost += item.price * item.quantity;
            });

            document.getElementById('checkedItemsCount').textContent = checkedCount;
            document.getElementById('totalItemsCount').textContent = totalCount;
            document.getElementById('totalEstimatedCost').textContent = `NT$ ${totalEstimatedCost.toLocaleString('zh-TW')}`; // Format with NT$ and comma
        }

        // Initial render when the page loads
        document.addEventListener('DOMContentLoaded', () => {
            renderDisasterKitItems();
        });
    </script>
</body>
</html>
